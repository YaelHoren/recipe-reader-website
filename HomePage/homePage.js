const recipes = [
  {
    title: "×¢×•×’×™×•×ª ×—×××” ×¢× ×©×•×§×•×œ×“ ×¦'×™×¤×¡",
    image: "../images/×—×××”.jpg",
    ingredients: [
  "200 ×’×¨× ×—×××”",
  "3 ×›×•×¡×•×ª ×§××— ×ª×•×¤×—",
  "2/3 ×›×•×¡ ×¡×•×›×¨",
  "×‘×™×¦×”",
  "1/2 ×›×¤×™×ª ×¡×•×“×” ×œ×©×ª×™×”",
  "×§××¦×•×¥ ××œ×—"
],

    steps: [
  "××¢×¨×‘×‘×™× ×”×›×œ - ×œ×©×™× ×‘×™×“.",
  "××•×¡×™×¤×™×:",
  "100 ×’×¨× ×©×•×§×•×œ×“ ×—×œ×‘ ×§×¦×•×¥",
  "100 ×’×¨× ×©×•×§×•×œ×“ ×œ×‘×Ÿ ×—×œ×‘×™ ×§×¦×•×¥",
  "200 ×’×¨× ×©×•×§×•×œ×“×¦'×™×¤×¡",
  "×•××¢×¨×‘×‘×™× ×•×™×•×¦×¨×™× ×¢×™×’×•×œ×™×.",
  "××•×¤×™× ×›Ö¾10 ×“×§×•×ª ×¢×“ ×©×”×¢×•×’×™×•×ª ××•×–×”×‘×•×ª."
]

  },
  {
    title: "×××¤×™× ×¡ ×ª×¤×•×—×™× ×•×©×™×‘×•×œ×ª ×©×•×¢×œ ××•×¤×—×ª ×¡×•×›×¨",
    image: "../images/×××¤×™× ×¡.jpg",
    ingredients: [
      "2 ×‘×™×¦×™× L",
      "80 ×\"×œ ×©××Ÿ (×©×œ×™×© ×›×•×¡)",
      "×©×œ×™×© ×›×•×¡ ×¡×•×›×¨ ×—×•× ×“××¨×¨×”",
      "1/3 ×›×•×¡ ×¡×™×¨×•×¤ ××™×™×¤×œ",
      "3 ×ª×¤×•×—×™× ××§×•×œ×¤×™× ×—×ª×•×›×™× ×œ×§×•×‘×™×•×ª",
      "×›×•×¡ ×©×™×‘×•×œ×ª ×©×•×¢×œ ×“×§×” (×§×•×•××§×¨)",
      "140 ×’' ×§××— ×¨×’×™×œ (×›×•×¡)",
      "×›×¤×™×ª ×§×™× ××•×Ÿ",
      "×›×¤×™×ª ××‘×§×ª ××¤×™×™×”"
    ],
    steps: [
      "×œ×—×× ×ª× ×•×¨ ×œÖ¾180 ××¢×œ×•×ª ×•×œ×©××Ÿ ×ª×‘× ×™×ª ×©×§×¢×™× ×¢× ×¡×¤×¨×™×™ ×©××Ÿ.",
      "×‘×¢×–×¨×ª ××˜×¨×¤×” ×œ×˜×¨×•×£ ×‘×™×¦×™×, ×¡×•×›×¨ ×•×¡×™×¨×•×¤ ××™×™×¤×œ ×‘××©×š ×›××” ×©× ×™×•×ª. ×œ×”×•×¡×™×£ ××ª ×”×©××Ÿ ×•×§×•×‘×™×•×ª ×”×ª×¤×•×—×™×, ×œ×¢×¨×‘×‘ ×•×œ×”×•×¡×™×£ ××ª ×”×§××—, ×©×™×‘×•×œ×ª ×©×•×¢×œ, ××‘×§×ª ××¤×™×™×” ×•×œ×¢×¨×‘×‘ ×œ×ª×¢×¨×•×‘×ª ××—×™×“×”.",
      "×œ××œ× ××ª ×”×©×§×¢×™× ×•×œ××¤×•×ª ×›Ö¾25 ×“×§×•×ª. ××•××œ×¥ ×œ× ×¢×•×¥ ×§×™×¡× ×‘××¨×›×– ×”×××¤×™× ×¡ ×•×œ×•×•×“× ×©×”×•× ×™×•×¦× × ×§×™.",
      "×ª× ×• ×œ×××¤×™× ×¡ ×œ×”×ª×§×¨×¨ ×•×ª×™×”× ×• ××”×¨×™×— ×•×”×˜×¢× ×”××©×’×¢ ğŸ˜Š"
    ]
  },
  {
    title: "×¢×•×’×ª ×’×‘×™× ×” ×× ×•×§×“×ª",
    image: "../images/×¢×•×’×ª ×’×‘×™× ×” ×× ×•×§×“×ª.jpg",
    ingredients: [
      "750 ×’' ×’×‘×™× ×” ×œ×‘× ×” 5%",
      "200 ×’' ×©×× ×ª ×—××•×¦×”",
      "150 ×’' ×™×•×’×•×¨×˜ ×‘××ª×™×§×•×ª ××¢×•×“× ×ª",
      "250 ×’' ×¡×•×›×¨ (×›×•×¡ ×•×¨×‘×¢)",
      "140 ×’' ×§××— (×›×•×¡)",
      "40 ×’' ××™× ×¡×˜× ×˜ ×¤×•×“×™× ×’ ×•× ×™×œ (2 ×›×¤×•×ª)",
      "3 ×‘×™×¦×™× ×’×“×•×œ×•×ª",
      "2 ×›×¤×•×ª ×©×˜×•×—×•×ª ××‘×§×ª ×§×§××•"
    ],
    steps: [
      "×œ×—×× ×ª× ×•×¨ ×œÖ¾180 ××¢×œ×•×ª",
      "×œ×¢×¨×‘×‘ ××ª ×”×’×‘×™× ×”, ×”×™×•×’×•×¨×˜, ×”×©×× ×ª ×•×”×¡×•×›×¨",
      "×œ×”×•×¡×™×£ ××ª ×”×‘×™×¦×™×, ×”×§××— ×•××™× ×¡×˜× ×˜ ×•× ×™×œ ×•×œ×¢×¨×‘×‘ ×œ×‘×œ×™×œ×” ××—×™×“×”",
      "×œ×”×•×¦×™× ×›Ö¾4â€“6 ×›×¤×•×ª ×‘×œ×™×œ×”, ×œ×¢×¨×‘×‘ ×¢× ×”×§×§××• ×•×œ×©××•×¨ ×‘×¦×“",
      "×œ×©×˜×— ××ª ×”×‘×œ×™×œ×” ×”×‘×”×™×¨×” ×‘×ª×‘× ×™×ª, ×œ×–×œ×£ ××ª ×”×›×”×” ×›× ×§×•×“×•×ª ××¢×œ",
      "×œ××¤×•×ª ×›Ö¾40 ×“×§×•×ª ×¢×“ ×©×”×¢×•×’×” ××ª×™×™×¦×‘×ª",
      "×œ×§×¨×¨ ×›××” ×©×¢×•×ª ×œ×¤× ×™ ×©×—×•×ª×›×™× â€“ ×¢×“×™×£ ×œ×”×›×™×Ÿ ×™×•× ××¨××©"
    ]
  },
  {
    title: "×¢×•×’×ª ××™×™×¤×œ ×¨×›×” ×•×¢×¡×™×¡×™×ª ×™×¨×§×•×ª",
    image: "../images/×¢×•×’×ª ××™×™×¤×œ.jpg",
    ingredients: [
      "3 ×‘×™×¦×™× ×’×“×•×œ×•×ª / 4 ×‘×™×¦×™× L",
      "200 ×’' ×¡×•×›×¨ (×›×•×¡)",
      "180 ×\"×œ ×©××Ÿ (3/4 ×›×•×¡)",
      "240 ×\"×œ ×ª×” (×›×•×¡)",
      "×›×¤×™×ª ×§×™× ××•×Ÿ",
      "×›×¤×™×ª ×©×˜×•×—×” ××‘×§×ª ×¡×•×“×” ×œ×©×ª×™×™×”",
      "280 ×’' ×§××— (2 ×›×•×¡×•×ª)",
      "2 ×›×¤×™×•×ª ××‘×§×ª ××¤×™×™×”",
      "×¡×™×¨×•×¤ ××™×™×¤×œ (×œ×§×™×©×•×˜ / ×œ×¦×™×¤×•×™)"
    ],
    steps: [
      "×œ×”×›×™×Ÿ ×›×•×¡ ×ª×” ×›××• ×©××•×”×‘×™×, ×œ×”×©××™×¨ ××ª ×”×ª×™×•×Ÿ 5 ×“×§×•×ª, ×œ×”×•×¦×™× ×•×œ×§×¨×¨ ××ª ×”×ª×” 15 ×“×§×•×ª",
      "×œ×—×× ×ª× ×•×¨ ×œÖ¾180 ××¢×œ×•×ª",
      "×‘××™×§×¡×¨ (××• ×™×“× ×™×ª) ×œ×¢×¨×‘×‘ ×‘×™×¦×™×, ×¡×•×›×¨, ×ª×”, ×©××Ÿ ×•××– ××ª ×©××¨ ×”××¦×¨×›×™× ×¢×“ ×œ×§×‘×œ×ª ×‘×œ×™×œ×” × ×•×–×œ×™×ª ×•××—×™×“×”",
      "×œ×”×¢×‘×™×¨ ×œ×ª×‘× ×™×ª ××©×•×× ×ª ×•×œ××¤×•×ª ×›Ö¾45â€“50 ×“×§×•×ª ××• ×¢×“ ×©×§×™×¡× ×™×•×¦× ×™×‘×©",
      "×›×©×”×¢×•×’×” ×™×•×¦××ª ××”×ª× ×•×¨, ×œ×”×–×œ×™×£ ×¢×œ×™×” ×›×—×¦×™ ×›×•×¡ ×¡×™×¨×•×¤ ××™×™×¤×œ ×‘× ×“×™×‘×•×ª"
    ]
  }
];

let isSpeaking = false;
let stopRequested = false;

function openModal(index) {
  const recipe = recipes[index];

  // ××™×¤×•×¡ ××¦×‘ ×”×§×¨××”
  speechSynthesis.cancel();
  isSpeaking = false;
  stopRequested = false;

  document.getElementById("modal-title").innerText = recipe.title;
  document.getElementById("modal-image").src = recipe.image;

  const ingredientsList = document.getElementById("modal-ingredients");
  ingredientsList.innerHTML = "";
  recipe.ingredients.forEach(item => {
    const li = document.createElement("li");
    li.textContent = item;
    ingredientsList.appendChild(li);
  });

  const stepsList = document.getElementById("modal-steps");
  stepsList.innerHTML = "";
  recipe.steps.forEach(step => {
    const li = document.createElement("li");
    li.textContent = step;
    stepsList.appendChild(li);
  });

  // ×›×¤×ª×•×¨×™ ×”×§×¨××” ×¢× ×ª××•× ×•×ª
  const buttonsDiv = document.getElementById("read-buttons");
  buttonsDiv.innerHTML = `
    <img src="../images/play.png" id="play-btn" class="icon-button" alt="Play" />
    <img src="../images/pause.png" id="pause-btn" class="icon-button" alt="Pause" style="display: none;" />
    <img src="../images/restart.png" id="restart-btn" class="icon-button" alt="Restart" />
  `;

  const playBtn = document.getElementById("play-btn");
  const pauseBtn = document.getElementById("pause-btn");
  const restartBtn = document.getElementById("restart-btn");

  playBtn.onclick = () => {
    const combinedSteps = [
      `×©× ×”××ª×›×•×Ÿ: ${recipe.title}`,
      "×”××¦×¨×›×™× ×”×:",
      ...recipe.ingredients,
      "×”×•×¨××•×ª ×”×”×›× ×”:",
      ...recipe.steps
    ];

    if (!isSpeaking) {
      speakSteps(combinedSteps);
      playBtn.style.display = "none";
      pauseBtn.style.display = "inline-block";
    } else {
      speechSynthesis.resume();
      playBtn.style.display = "none";
      pauseBtn.style.display = "inline-block";
    }
  };

  pauseBtn.onclick = () => {
    speechSynthesis.pause();
    playBtn.style.display = "inline-block";
    pauseBtn.style.display = "none";
  };

  restartBtn.onclick = () => {
    const combinedSteps = [
      `×©× ×”××ª×›×•×Ÿ: ${recipe.title}`,
      "×”××¦×¨×›×™× ×”×:",
      ...recipe.ingredients,
      "×”×•×¨××•×ª ×”×”×›× ×”:",
      ...recipe.steps
    ];

    speakSteps(combinedSteps, true);
    playBtn.style.display = "none";
    pauseBtn.style.display = "inline-block";
  };

  // ×œ×¤×ª×•×— ××ª ×”××•×“××œ
  document.getElementById("recipe-modal").style.display = "block";
}

function closeModal() {
  stopSpeaking();
  speechSynthesis.cancel();
  isSpeaking = false;
  stopRequested = false;
  document.getElementById("recipe-modal").style.display = "none";
}

function speakSteps(steps, restart = false) {
  if (restart) {
    speechSynthesis.cancel();
  }
  isSpeaking = true;
  stopRequested = false;

  let index = 0;

  function speakNext() {
    if (stopRequested || index >= steps.length) {
      isSpeaking = false;
      return;
    }

    const utterance = new SpeechSynthesisUtterance(steps[index]);
    utterance.lang = "he-IL";
    utterance.onend = () => {
      index++;
      if (!stopRequested) speakNext();
    };
    speechSynthesis.speak(utterance);
  }

  speakNext();
}

function stopSpeaking() {
  stopRequested = true;
  speechSynthesis.cancel();
}
